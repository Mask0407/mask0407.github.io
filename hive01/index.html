<html>

<head>
	<script src="../../prism.js"></script>
	<link href="../../prism.css" rel="stylesheet" />
	<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>个人博客</title>
<link rel="shortcut icon" href="https://mask0407.github.io/favicon.ico?v=1594806103646">
<script src="../../prism.js" ></script>
<link href="../../prism.css" rel="stylesheet" />
<link href="../../snow.css" rel="stylesheet" />
<link rel="stylesheet" href="https://mask0407.github.io/styles/main.css">
<meta name="description" content="温故而知新" />
<script src='//unpkg.com/valine/dist/Valine.min.js'></script>

<link rel="stylesheet" href="/media/fonts/iconfont.css">
<link href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Rosario:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">

<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.0/velocity.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.0/velocity.ui.min.js"></script>

</head>

<body>
	


<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>
<div class="snow"></div>

	<div class="head-top-line"></div>
	<div class="header-box">
		<header class="header">

	<div class="blog-header" id="header">
		<div class="section-layout-wrapper">
			<div class="site-meta">
				<div class="nav-toggle" id="nav_toggle">
					<div class="toggle-box">
						<div class="line line-top"></div>
						<div class="line line-center"></div>
						<div class="line line-bottom"></div>
					</div>
				</div>
				<div class="site-title">
					<a href="/" class="brand">
						<span>个人博客</span>
					</a>
				</div>
				<p class="subtitle"></p>
				<nav class="site-nav" id="site_nav">
					
					<li class="nav-item ">
						<a href="/">
							<!-- <i class="iconfont icon-home"></i> -->
							首页
						</a>
					</li>
					
					<li class="nav-item ">
						<a href="/archives">
							<!-- <i class="iconfont icon-home"></i> -->
							归档
						</a>
					</li>
					
					<li class="nav-item ">
						<a href="/tags">
							<!-- <i class="iconfont icon-home"></i> -->
							标签
						</a>
					</li>
					
					<li class="nav-item ">
						<a href="/post/about">
							<!-- <i class="iconfont icon-home"></i> -->
							关于
						</a>
					</li>
					
				</nav>
				<input type="serch" id="serch" placeholder="搜索其实很简单">
			</div>

		</div>
	</div>
<!-- <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?3e11339a177ba7e34848b1f198c46e5c";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script> -->


</header>
<script type="text/javascript">

	let showNav = true;

	let navToggle = document.querySelector('#nav_toggle'),
		siteNav = document.querySelector('#site_nav');

	function navClick() {
		navToggle.classList.toggle('nav-toggle-active');
		siteNav.classList.toggle('nav-menu-active');
	}

	navToggle.addEventListener('click', navClick);  
</script>
	</div>
	<div class="main-continer">
		<div class="section-layout">
			<div class="section-layout-wrapper">

				<!-- <div class="section-box"> -->
				<div class="section post">
					<section class="section-items">
						<div class="article-box">
    <header class="post-header">
  <h1 class="post-title">
    <a class="post-title-link" href="https://mask0407.github.io/hive01/">
      Hadoop生态圈-Hive
    </a>
  </h1>
  <div class="post-meta">
    <span class="meta-item">
      <i class="iconfont icon-calendar_empty"></i>
      <span class="pc-show">发布于</span>
      <span>2020-06-29</span>
    </span>
    
      <span class="meta-item">
        <span class="post-meta-divider">|</span>
        <i class="iconfont icon-folder_open_alt"></i>
        <span class="pc-show">分类于</span>
        
          
            <a href="https://mask0407.github.io/yn_9TWp8Z/">
              <span>Hive</span>
            </a>、
          
        
          
            <a href="https://mask0407.github.io/mWPQYQko7/">
              <span>Hadoop</span>
            </a>、
          
        
          
            <a href="https://mask0407.github.io/1ffDVERZml/">
              <span>大数据</span>
            </a>
          
        
      </span>
    
    <span class="meta-item">
      <span class="post-meta-divider">|</span>
      <i class="iconfont icon-time"></i>
      <span>12分钟</span>
    </span>
    <span class="meta-item">
      <span class="post-meta-divider">|</span>
      <i class="iconfont icon-keyboard"></i>
      <span class="pc-show">2362字数</span>
    </span>
  </div>
</header>
</div>
						<div class="post-body" id="post_body">
							<p><ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#hive%E5%BC%95%E8%A8%80">Hive引言</a></li>
<li><a href="#hive%E7%9A%84%E8%BF%90%E8%A1%8C%E5%8E%9F%E7%90%86">Hive的运行原理</a></li>
<li><a href="#hive%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA">Hive环境搭建</a></li>
<li><a href="#hive%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C">Hive基本操作</a></li>
<li><a href="#metastore%E7%9A%84%E6%9B%BF%E6%8D%A2%E9%97%AE%E9%A2%98">MetaStore的替换问题</a></li>
<li><a href="#hive%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95">Hive基础语法</a>
<ul>
<li><a href="#1hql">1.HQL</a></li>
</ul>
</li>
<li><a href="#2%E8%A1%A8%E6%93%8D%E4%BD%9C">2.表操作</a>
<ul>
<li><a href="#1%E7%AE%A1%E7%90%86%E8%A1%A8-managed_table">1）管理表 (MANAGED_TABLE)</a></li>
<li><a href="#2%E5%A4%96%E9%83%A8%E8%A1%A8">2)外部表</a></li>
<li><a href="#3-%E5%88%86%E5%8C%BA%E8%A1%A8%E4%BC%98%E5%8C%96%E6%9F%A5%E8%AF%A2">3) 分区表【优化查询】</a></li>
<li><a href="#4%E6%A1%B6%E8%A1%A8">4）桶表</a></li>
<li><a href="#5%E4%B8%B4%E6%97%B6%E8%A1%A8">5）临时表</a></li>
</ul>
</li>
<li><a href="#3-%E6%95%B0%E6%8D%AE%E7%9A%84%E5%AF%BC%E5%85%A5">3. 数据的导入</a>
<ul>
<li><a href="#1-%E5%9F%BA%E6%9C%AC%E5%AF%BC%E5%85%A5">1). 基本导入</a></li>
<li><a href="#2-%E9%80%9A%E8%BF%87as%E5%85%B3%E9%94%AE%E5%AE%8C%E6%88%90%E6%95%B0%E6%8D%AE%E7%9A%84%E5%AF%BC%E5%85%A5">2). 通过as关键完成数据的导入</a></li>
<li><a href="#3-%E9%80%9A%E8%BF%87insert%E7%9A%84%E6%96%B9%E5%BC%8F%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE">3). 通过insert的方式导入数据</a></li>
<li><a href="#4-hdfs%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE">4). hdfs导入数据</a></li>
<li><a href="#5-%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE%E8%BF%87%E7%A8%8B%E4%B8%AD%E6%95%B0%E6%8D%AE%E7%9A%84%E8%A6%86%E7%9B%96">5). 导入数据过程中数据的覆盖</a></li>
<li><a href="#6-%E9%80%9A%E8%BF%87hdfs%E7%9A%84api%E5%AE%8C%E6%88%90%E6%96%87%E4%BB%B6%E7%9A%84%E4%B8%8A%E4%BC%A0">6). 通过HDFS的API完成文件的上传</a></li>
</ul>
</li>
<li><a href="#4-%E6%95%B0%E6%8D%AE%E7%9A%84%E5%AF%BC%E5%87%BA">4. 数据的导出</a>
<ul>
<li><a href="#1-sqoop">1). sqoop</a></li>
</ul>
</li>
<li><a href="#2-insert%E7%9A%84%E6%96%B9%E5%BC%8F">2). insert的方式</a>
<ul>
<li><a href="#3-%E9%80%9A%E8%BF%87hdfs%E7%9A%84api%E5%AE%8C%E6%88%90%E6%96%87%E4%BB%B6%E7%9A%84%E4%B8%8B%E8%BD%BD">3). 通过HDFS的API完成文件的下载</a></li>
<li><a href="#4-%E5%91%BD%E4%BB%A4%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E6%96%B9%E5%BC%8F">4). 命令行脚本的方式</a></li>
</ul>
</li>
<li><a href="#5-hive%E6%8F%90%E4%BE%9B%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA%E7%9A%84%E5%B7%A5%E5%85%B7">5. Hive提供导入，导出的工具</a></li>
<li><a href="#6%E4%B8%8Emr%E7%9B%B8%E5%85%B3%E7%9A%84%E9%85%8D%E7%BD%AE">6.与MR相关的配置</a></li>
</ul>
</li>
</ul>
(Hive)</p>
<h2 id="hive引言">Hive引言</h2>
<ol>
<li>什么是Hive</li>
</ol>
<pre><code class="language-markdown">    hive是facebook开源，并捐献给了apache组织，作为apache组织的顶级项目。 hive.apache.org
    hive是一个基于大数据技术的数据仓库技术  DataWareHouse (数仓)
        数据库  DataBase
               数据量级小，数据价值高
        数据仓库 DataWareHouse
               数据体量大，数据价值低
    底层依附是HDFS,MapReduce
</code></pre>
<ol start="2">
<li>Hive的好处</li>
</ol>
<pre><code class="language-markdown">Hive让程序员应用时，书写SQL语句，最终由Hive把SQL语句转换成MapReduce运行，这样简化了程序员的工作。
</code></pre>
<h2 id="hive的运行原理">Hive的运行原理</h2>
<pre><code class="language-markdown">Hive是将大多数Hive SQL语句底层转换为MapReduce 运行Job作业来进行数据的处理
</code></pre>
<h2 id="hive环境搭建">Hive环境搭建</h2>
<pre><code class="language-markdown">1. linux服务器  ip 映射  主机名  关闭防火墙  关闭selinux  ssh免密登陆 jdk
2. 搭建hadoop环境
3. 安装Hive
   3.1 解压缩hive 
   3.2 hive_home/conf/hive-env.sh [改名]
       HADOOP_HOME=/opt/install/hadoop-2.5.2
       export HIVE_CONF_DIR=/opt/install/apache-hive-0.13.1-bin/conf
   3.2 hdfs创建2个目录
       /tmp
       /user/hive/warehouse
       bin/hdfs dfs -mkdir /tmp
       bin/hdfs dfs -mkdir /user/hive/warehouse
   3.3 启动hive
       bin/hive 
   3.4 jps
       runjar
</code></pre>
<h2 id="hive基本操作">Hive基本操作</h2>
<pre><code class="language-shell"># 创建数据库
create database [if not exists] test;
# 查看所有数据库
 show databases;
# 使用数据库
 use db_name;
# 删除空数据库 
 drop database db_name;
 drop database db_name cascade;
# 查看数据库的本质
 hive中的数据库 本质是 hdfs的目录 /user/hive/warehouse/test.db
  
# 查看当前数据库下的所有表
  show tables;
# 建表语句
  create table t_user(
    id int ,
    name string
   )row format delimited fields terminated by '\t';
# 查看表的本质
  hive中的表  本质是 hdfs的目录 /user/hive/warehouse/test.db/t_user
# 删除表
  drop table t_user;
  
# hive中向表导入数据
  load data local inpath '/root/hive/data' into table t_user;
# hive导入数据的本质
  load data local inpath '/root/hive/data' into table t_user;
  1. 导入数据 本质本质上就是 hdfs 上传文件
  bin/hdfs dfs -put /root/hive/data /user/hive/warehouse/test.db/t_user;
  2. 上传了重复数据，hive导数据时，会自动修改文件名
  3. 查询某一个张表时，Hive会把表中这个目录下所有文件的内容，整合查询出来
  
  
# SQL(类SQL 类似于SQL HQL Hive Query Language)
select * from t_user;
select id from t_user;
1. Hive把SQL转换成MapReduce (如果清洗数据 没有Reduce)
2. Hive在绝大多数情况下运行MR,但是在* limit操作时不运行MR
</code></pre>
<h2 id="metastore的替换问题">MetaStore的替换问题</h2>
<p>Hive中的MetaStore把HDFS对应结构，与表对应结果做了映射（对应）。但是默认情况下hive的metaStore应用的是derby数据库，只支持一个client访问。</p>
<ol>
<li>Hive中元数据库Derby替换成MySQL(Oracle)</li>
</ol>
<pre><code class="language-markdown">0. 删除hdfs /user/hive/warehouse目录，并重新建立
1. linux mysql
   yum -y install mysql-server
2. 启动mysql服务并设置管理员密码
   service mysqld start
   /usr/bin/mysqladmin -u root password '123456'
3. 打开mysql远程访问权限
   GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY '123456';
   flush privileges;   
   use mysql 
   delete from user where host like 'hadoop%';
   delete from user where host like 'l%';
   delete from user where host like '1%';
   service mysqld restart
4. 创建conf/hive-site.xml
   mv hive-default.xml.template hive-site.xml
   hive-site.xml
   &lt;property&gt;
	  &lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt;
	  &lt;value&gt;jdbc:mysql://CentOSA:3306/metastore?createDatabaseIfNotExist=true&lt;/value&gt;
	  &lt;description&gt;the URL of the MySQL database&lt;/description&gt;
	&lt;/property&gt;

	&lt;property&gt;
	  &lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt;
	  &lt;value&gt;com.mysql.jdbc.Driver&lt;/value&gt;
	  &lt;description&gt;Driver class name for a JDBC metastore&lt;/description&gt;
	&lt;/property&gt;

	&lt;property&gt;
	  &lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt;
	  &lt;value&gt;root&lt;/value&gt;
	&lt;/property&gt;

	&lt;property&gt;
	  &lt;name&gt;javax.jdo.option.ConnectionPassword&lt;/name&gt;
	  &lt;value&gt;123456&lt;/value&gt;
	&lt;/property&gt;
5. hive_home/lib 上传mysql driver jar包
</code></pre>
<h2 id="hive基础语法">Hive基础语法</h2>
<h3 id="1hql">1.HQL</h3>
<pre><code class="language-markdown">1. 基本查询
   select * from table_name # 不启动mr
   select id from table_name # 启动mr
2. 条件查询 where
   select id,name from t_users where name = 'mask1';
   2.1 比较查询  =  ！=  &gt;=  &lt;=
       select id,name from t_users where age &gt; 20;
   2.2 逻辑查询  and or  not
       select id,name,age from t_users where name = 'mask' or age&gt;30;
   2.3 谓词运算
       between and
       select name,salary from t_users where salary between 100 and 300;
       in
       select name,salary from t_users where salary in (100,300);
       is null
       select name,salary from t_users where salary is null;
       like
       select name,salary from t_users where name like 'mask%';
       select name,salary from t_users where name like 'mask__';
       select name,salary from t_users where name like 'mask%' and length(name) = 6;
3. 排序 order by [底层使用的是 map sort  group sort  compareto]
   select name,salary from t_users order by salary desc;
4. 去重 distinct
   select distinct(age) from t_users;
5. 分页 [Mysql可以定义起始的分页条目，但是Hive不可以]
   select * from t_users limit 3;  
6. 聚合函数（分组函数） count() avg() max() min() sum() 
   count(*)  count(id) 区别
7. group by
   select max(salary) from t_users group by age;
   规矩： select 后面只能写 分组依据和聚合函数 （Oracle报错，Mysql不报错，结果不对）
8. having 
   分组后，聚合函数的条件判断用having
   select max(salary) from t_users group by age having max(salary) &gt; 800;
9. hive不支持子查询 
10. hive内置函数 
    show functions 

    length(column_name)  获得列中字符串数据长度
    substring(column_name,start_pos,total_count)
    concat(col1,col2)
    to_data('yyyy-mm-dd')
    year(data) 获得年份
    month(data)
    date_add
    ....
    select year(to_date('1999-10-11')) ;
11. 多表操作
    inner join
    select e.name,e.salary,d.dname
    from t_emp as e
    inner join t_dept as d
    on e.dept_id = d.id;
    
    select e.name,e.salary,d.dname
    from t_emp as e
    left join t_dept as d
    on e.dept_id = d.id;
    
    select e.name,e.salary,d.dname
    from t_emp as e
    right join t_dept as d
    on e.dept_id = d.id;
    
    select e.name,e.salary,d.dname [mysql 不支持]
    from t_emp as e
    full join t_dept as d
    on e.dept_id = d.id; 
</code></pre>
<h2 id="2表操作">2.表操作</h2>
<h3 id="1管理表-managed_table">1）管理表 (MANAGED_TABLE)</h3>
<pre><code class="language-markdown">1. 基本管理表的创建
create table if not exists table_name(
column_name data_type,
column_name data_type
)row format delimited fields terminated by '\t' [location 'hdfs_path']

2. as 关键字创建管理表
create table if not exists table_name as select id,name from t_users [location ''];
表结构 由 查询的列决定，同时会把查询结果的数据 插入新表中

3. like 关键字创建管理表
create table if not exists table_name like t_users [location 'hdfs_path'];
表结构 和 like关键字后面的表 一致，但是没有数据是空表
</code></pre>
<p>细节操作</p>
<pre><code class="language-markdown">1. 数据类型 int string varchar char double float boolean  
2. location hdfs_path
   定制创建表的位置，默认是 /user/hive/warehouse/db_name.db/table_name
   create table t_mask(
   id,int
   name,string
   )row format delimited fields terminated by '\t' stored as textfile location /xiaohei ;
   启示：日后先有hdfs目录，文件，在创建表进行操作。
3. 查看hive表结构的命令
   desc table_name        describe table_name
   desc extended table_name
   desc formatted table_name 
</code></pre>
<h3 id="2外部表">2)外部表</h3>
<pre><code class="language-markdown">1. 基本
create external table if not exists table_name(
id int,
name string
) row delimited fields terminated by '\t' stored as textfile [location 'hdfs_path'];
2. as 
create external table if not exists table_name as select id,name from t_users [location ''];
3. like
create external table if not exists table_name like t_users [location 'hdfs_path'];
</code></pre>
<pre><code class="language-markdown">4. 管理表和外部表的区别
drop table t_users_as; 删除管理表时，直接删除metastore,同时删除hdfs的目录和数据文件
drop table t_user_ex;  删除外部表时，删除metastore的数据。
5. 外部表与管理表使用方式的区别
</code></pre>
<h3 id="3-分区表优化查询">3) 分区表【优化查询】</h3>
<p>分区表是为了提高条件查询时的效率</p>
<pre><code class="language-markdown">create table t_user_part(
id int,
name string,
age int,
salary int)partitioned by (data string) row format delimited fields terminated by '\t';

load data local inpath '/root/data15' into table t_user_part partition (date='15');
load data local inpath '/root/data16' into table t_user_part partition (date='16');

select * from t_user_part  全表数据进行的统计

select id from t_user_part where data='15' and age&gt;20;
</code></pre>
<h3 id="4桶表">4）桶表</h3>
<h3 id="5临时表">5）临时表</h3>
<h2 id="3-数据的导入">3. 数据的导入</h2>
<h3 id="1-基本导入">1). 基本导入</h3>
<pre><code class="language-markdown">   load data local inpath 'local_path' into table table_name
</code></pre>
<h3 id="2-通过as关键完成数据的导入">2). 通过as关键完成数据的导入</h3>
<pre><code class="language-markdown">   建表的同时，通过查询导入数据
   create table if not exists table_name as select id,name from t_users
</code></pre>
<h3 id="3-通过insert的方式导入数据">3). 通过insert的方式导入数据</h3>
<pre><code class="language-markdown">   #表格已经建好，通过查询导入数据。
   create table t_users_like like t_users;
   
   insert into table t_users_like select id,name,age,salary from t_users;
</code></pre>
<h3 id="4-hdfs导入数据">4). hdfs导入数据</h3>
<pre><code class="language-markdown">   load data inpath 'hdfs_path' into table table_name
</code></pre>
<h3 id="5-导入数据过程中数据的覆盖">5). 导入数据过程中数据的覆盖</h3>
<pre><code class="language-markdown">   load data inpath 'hdfs_path' overwrite into table table_name
   本质 把原有表格目录的文件全部删除，再上传新的
</code></pre>
<h3 id="6-通过hdfs的api完成文件的上传">6). 通过HDFS的API完成文件的上传</h3>
<pre><code class="language-markdown">   bin/hdfs dfs -put /xxxx  /user/hive/warehouse/db_name.db/table_name
</code></pre>
<h2 id="4-数据的导出">4. 数据的导出</h2>
<h3 id="1-sqoop">1). sqoop</h3>
<pre><code class="language-markdown">     hadoop的一种辅助工具  HDFS/Hive  &lt;------&gt; RDB (MySQL,Oracle)
</code></pre>
<h2 id="2-insert的方式">2). insert的方式</h2>
<pre><code class="language-markdown">      #xiaohei一定不能存在，自动创建
      insert overwrite 【local】 directory '/root/xiaohei' select name from t_user; 
</code></pre>
<h3 id="3-通过hdfs的api完成文件的下载">3). 通过HDFS的API完成文件的下载</h3>
<pre><code class="language-markdown">      bin/hdfs dfsd -get /user/hive/warehouse/db_name.db/table_name /root/xxxx
</code></pre>
<h3 id="4-命令行脚本的方式">4). 命令行脚本的方式</h3>
<pre><code class="language-markdown">      bin/hive --database 'test' -f /root/hive.sql &gt; /root/result
</code></pre>
<h2 id="5-hive提供导入导出的工具">5. Hive提供导入，导出的工具</h2>
<pre><code class="language-markdown">      1. export 导出
      	export table tb_name to 'hdfs_path'
      2. import 导入
      	import table tb_name from 'hdfs_path'
</code></pre>
<h2 id="6与mr相关的配置">6.与MR相关的配置</h2>
<pre><code class="language-xml">#与MR相关的参数
Map --&gt; Split  ---&gt; Block 
#reduce相关个数
mapred-site.xml
&lt;property&gt;
     &lt;name&gt;mapreduce.job.reduces&lt;/name&gt;
     &lt;value&gt;1&lt;/value&gt;
&lt;/property&gt;
hive-site.xml
&lt;!--1G--&gt;
&lt;property&gt;
	  &lt;name&gt;hive.exec.reducers.bytes.per.reducer&lt;/name&gt;
	  &lt;value&gt;1000000000&lt;/value&gt;
&lt;/property&gt;
&lt;property&gt;
     &lt;name&gt;hive.exec.reducers.max&lt;/name&gt;
     &lt;value&gt;999&lt;/value&gt;
&lt;/property&gt;
</code></pre>

						</div>
						<div class="post-footer">
  <ul class="post-copyright">
    <li class="post-copyright-author">
      <strong>本文作者：</strong>
      个人博客
    </li>
    <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://mask0407.github.io/hive01/" title="Hadoop生态圈-Hive">https://mask0407.github.io/hive01/</a>
    </li>
    <li class="post-copyright-license">
      <strong>版权声明： </strong>
      本博客所有文章除特别声明外,转载请注明出处！
    </li>
  </ul>
  <div class="tags">
    
      <a href="https://mask0407.github.io/yn_9TWp8Z/"># Hive</a>
    
      <a href="https://mask0407.github.io/mWPQYQko7/"># Hadoop</a>
    
      <a href="https://mask0407.github.io/1ffDVERZml/"># 大数据</a>
    
  </div>
  <div class="nav">
    <div class="nav-prev">
      
        <i class="iconfont icon-angle_left"></i>
        <a class="nav-pc-next" href="https://mask0407.github.io/flume01/">Flume 介绍与使用</a class="nav-pc-next">
        <a class="nav-mobile-prev" href="https://mask0407.github.io/flume01/">上一篇</a>
      
    </div>
    <div class="nav-next">
      
        <a class="nav-pc-next" href="https://mask0407.github.io/hive00/">Hive安装(超详细)</a>
        <a class="nav-mobile-next" href="https://mask0407.github.io/hive00/">下一篇</a>
        <i class="iconfont icon-angle_right"></i>
      
    </div>
  </div>
</div>
						
						<div class="comment"></div>
					</section>

				</div>
				<div class="sidebar">
    <div class="sidebar-wrapper">
  <div class="sidebar-item">
    <p class="site-author-name">关于博主</p>
    <img class="site-author-image" src="https://mask0407.github.io/images/avatar.png"/>
    <p class="site-description">Memory</p>
    <p class="site-description">温故而知新</p>
  </div>
  <div class="sidebar-item side-item-stat">
    <div class="sidebar-item-box">
      <a href="/archives/">
        <span class="site-item-stat-count">40</span>
        <span class="site-item-stat-name">日志</span>
      </a>
    </div>
    <div class="sidebar-item-box">
      <a href="">
        <span class="site-item-stat-count">20</span>
        <span class="site-item-stat-name">分类</span>
      </a>
    </div>
    <div class="sidebar-item-box">
      <a href="/tags/">
        <span class="site-item-stat-count">20</span>
        <span class="site-item-stat-name">标签</span>
      </a>
    </div>
  </div>
  <div class="sidebar-item">
    <span class="site-item-rss">
        <i class="iconfont icon-rss"></i>
        <a href="https://mask0407.github.io/atom.xml" target="_blank">RSS</a>
    </span>
  </div>
  <div class="sidebar-item sidebar-item-social">
    <div class="social-item">
      <a href="https://www.github.com/memorypro">
        <i class="iconfont icon-github"></i> GitHub
      </a>
      <a href="">
        <i class="iconfont icon-twitter"></i> Twitter
      </a>
    </div>
    <div class="social-item">
      <a href="">
        <i class="iconfont icon-globe"></i> 豆瓣
      </a>
      <a href="">
        <i class="iconfont icon-globe"></i> 知乎
      </a>
    </div>
  </div>
</div>

<div class="sidebar-wrapper">
  <div class="sidebar-item">
    <p class="site-author-name">文章分类</p>
  </div>
  <div>
    <ul class="site-meta-tags">
      
        <li >
          <a  href="https://mask0407.github.io/prgNNygPR/">
            python
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/-GjvL3Wxg/">
            算法
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/WwvK-h-X5/">
            机器学习
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/aAuqPKSPG/">
            Spark
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/1ffDVERZml/">
            大数据
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/yn_9TWp8Z/">
            Hive
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/mWPQYQko7/">
            Hadoop
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/rmtSLWko1/">
            java
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/vIyAknLKTN/">
            线程
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/NcOh8FcvU/">
            NoSql
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/b_rV1mTAIK/">
            Redis
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/77iES6Gqn/">
            Docker
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/zTsEErFnpM/">
            GreenPlum
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/uyhs3Xoe6/">
            SpringCloud
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/rg_9e-j4YM/">
            微服务
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/F5ekRJs32/">
            Elasticsearch
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/8sXwjdxU1/">
            Storm
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/wCHLQOml4/">
            Kafka
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/QZpGpA6c1/">
            Flume
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/-ElJdKXRJ/">
            Hbase
          </a>
        </li>

      
    </ul>
     
  </div>

</div>


<div class="sidebar-wrapper">
  <div class="sidebar-item">
    <p class="site-author-name">友情链接</p>
  </div>
  <div class="social-item">
    <ul style=" list-style: none; margin-left: -10px;" >
    
      
        <li >
          <a  href="https://mask0407.github.io/prgNNygPR/">
            python
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/-GjvL3Wxg/">
            算法
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/WwvK-h-X5/">
            机器学习
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/aAuqPKSPG/">
            Spark
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/1ffDVERZml/">
            大数据
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/yn_9TWp8Z/">
            Hive
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/mWPQYQko7/">
            Hadoop
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/rmtSLWko1/">
            java
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/vIyAknLKTN/">
            线程
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/NcOh8FcvU/">
            NoSql
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/b_rV1mTAIK/">
            Redis
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/77iES6Gqn/">
            Docker
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/zTsEErFnpM/">
            GreenPlum
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/uyhs3Xoe6/">
            SpringCloud
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/rg_9e-j4YM/">
            微服务
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/F5ekRJs32/">
            Elasticsearch
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/8sXwjdxU1/">
            Storm
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/wCHLQOml4/">
            Kafka
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/QZpGpA6c1/">
            Flume
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/-ElJdKXRJ/">
            Hbase
          </a>
        </li>

      

      <li > <a  href="">链接1</a></li>
      <li > <a  href="">链接1</a></li>
      <li > <a  href="">链接1</a></li>
      <li > <a  href="">链接1</a></li>

    </ul>
     
  </div>

</div>

</div>
				<!-- 
<div class="sidebar">
    <div class="sidebar-wrapper" id="sidebar">
      
        <div class="post-list-sidebar">
          <div class="sidebar-title">
            <span id="tocSideBar" class="sidebar-title-item sidebar-title-active">文章目录</span>
            <span id="metaSideBar" class="sidebar-title-item">站点概览</span>
          </div>
        </div>
      
      <div class="sidebar-body" id="sidebar_body">
        
          <div class="post-side-meta" id="post_side_meta">
            <div class="sidebar-wrapper">
  <div class="sidebar-item">
    <p class="site-author-name">关于博主</p>
    <img class="site-author-image" src="https://mask0407.github.io/images/avatar.png"/>
    <p class="site-description">Memory</p>
    <p class="site-description">温故而知新</p>
  </div>
  <div class="sidebar-item side-item-stat">
    <div class="sidebar-item-box">
      <a href="/archives/">
        <span class="site-item-stat-count">40</span>
        <span class="site-item-stat-name">日志</span>
      </a>
    </div>
    <div class="sidebar-item-box">
      <a href="">
        <span class="site-item-stat-count">20</span>
        <span class="site-item-stat-name">分类</span>
      </a>
    </div>
    <div class="sidebar-item-box">
      <a href="/tags/">
        <span class="site-item-stat-count">20</span>
        <span class="site-item-stat-name">标签</span>
      </a>
    </div>
  </div>
  <div class="sidebar-item">
    <span class="site-item-rss">
        <i class="iconfont icon-rss"></i>
        <a href="https://mask0407.github.io/atom.xml" target="_blank">RSS</a>
    </span>
  </div>
  <div class="sidebar-item sidebar-item-social">
    <div class="social-item">
      <a href="https://www.github.com/memorypro">
        <i class="iconfont icon-github"></i> GitHub
      </a>
      <a href="">
        <i class="iconfont icon-twitter"></i> Twitter
      </a>
    </div>
    <div class="social-item">
      <a href="">
        <i class="iconfont icon-globe"></i> 豆瓣
      </a>
      <a href="">
        <i class="iconfont icon-globe"></i> 知乎
      </a>
    </div>
  </div>
</div>

<div class="sidebar-wrapper">
  <div class="sidebar-item">
    <p class="site-author-name">文章分类</p>
  </div>
  <div>
    <ul class="site-meta-tags">
      
        <li >
          <a  href="https://mask0407.github.io/prgNNygPR/">
            python
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/-GjvL3Wxg/">
            算法
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/WwvK-h-X5/">
            机器学习
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/aAuqPKSPG/">
            Spark
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/1ffDVERZml/">
            大数据
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/yn_9TWp8Z/">
            Hive
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/mWPQYQko7/">
            Hadoop
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/rmtSLWko1/">
            java
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/vIyAknLKTN/">
            线程
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/NcOh8FcvU/">
            NoSql
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/b_rV1mTAIK/">
            Redis
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/77iES6Gqn/">
            Docker
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/zTsEErFnpM/">
            GreenPlum
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/uyhs3Xoe6/">
            SpringCloud
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/rg_9e-j4YM/">
            微服务
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/F5ekRJs32/">
            Elasticsearch
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/8sXwjdxU1/">
            Storm
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/wCHLQOml4/">
            Kafka
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/QZpGpA6c1/">
            Flume
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/-ElJdKXRJ/">
            Hbase
          </a>
        </li>

      
    </ul>
     
  </div>

</div>


<div class="sidebar-wrapper">
  <div class="sidebar-item">
    <p class="site-author-name">友情链接</p>
  </div>
  <div class="social-item">
    <ul style=" list-style: none; margin-left: -10px;" >
    
      
        <li >
          <a  href="https://mask0407.github.io/prgNNygPR/">
            python
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/-GjvL3Wxg/">
            算法
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/WwvK-h-X5/">
            机器学习
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/aAuqPKSPG/">
            Spark
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/1ffDVERZml/">
            大数据
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/yn_9TWp8Z/">
            Hive
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/mWPQYQko7/">
            Hadoop
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/rmtSLWko1/">
            java
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/vIyAknLKTN/">
            线程
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/NcOh8FcvU/">
            NoSql
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/b_rV1mTAIK/">
            Redis
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/77iES6Gqn/">
            Docker
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/zTsEErFnpM/">
            GreenPlum
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/uyhs3Xoe6/">
            SpringCloud
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/rg_9e-j4YM/">
            微服务
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/F5ekRJs32/">
            Elasticsearch
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/8sXwjdxU1/">
            Storm
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/wCHLQOml4/">
            Kafka
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/QZpGpA6c1/">
            Flume
          </a>
        </li>

      
        <li >
          <a  href="https://mask0407.github.io/-ElJdKXRJ/">
            Hbase
          </a>
        </li>

      

      <li > <a  href="">链接1</a></li>
      <li > <a  href="">链接1</a></li>
      <li > <a  href="">链接1</a></li>
      <li > <a  href="">链接1</a></li>

    </ul>
     
  </div>

</div>

          </div>
          <div class="post-toc sidebar-body-active" id="post_toc" style="opacity: 1;">
            <div class="toc-box">
  <div class="toc-wrapper" id="toc_wrapper">
    <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#hive%E5%BC%95%E8%A8%80">Hive引言</a></li>
<li><a href="#hive%E7%9A%84%E8%BF%90%E8%A1%8C%E5%8E%9F%E7%90%86">Hive的运行原理</a></li>
<li><a href="#hive%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA">Hive环境搭建</a></li>
<li><a href="#hive%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C">Hive基本操作</a></li>
<li><a href="#metastore%E7%9A%84%E6%9B%BF%E6%8D%A2%E9%97%AE%E9%A2%98">MetaStore的替换问题</a></li>
<li><a href="#hive%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95">Hive基础语法</a>
<ul>
<li><a href="#1hql">1.HQL</a></li>
</ul>
</li>
<li><a href="#2%E8%A1%A8%E6%93%8D%E4%BD%9C">2.表操作</a>
<ul>
<li><a href="#1%E7%AE%A1%E7%90%86%E8%A1%A8-managed_table">1）管理表 (MANAGED_TABLE)</a></li>
<li><a href="#2%E5%A4%96%E9%83%A8%E8%A1%A8">2)外部表</a></li>
<li><a href="#3-%E5%88%86%E5%8C%BA%E8%A1%A8%E4%BC%98%E5%8C%96%E6%9F%A5%E8%AF%A2">3) 分区表【优化查询】</a></li>
<li><a href="#4%E6%A1%B6%E8%A1%A8">4）桶表</a></li>
<li><a href="#5%E4%B8%B4%E6%97%B6%E8%A1%A8">5）临时表</a></li>
</ul>
</li>
<li><a href="#3-%E6%95%B0%E6%8D%AE%E7%9A%84%E5%AF%BC%E5%85%A5">3. 数据的导入</a>
<ul>
<li><a href="#1-%E5%9F%BA%E6%9C%AC%E5%AF%BC%E5%85%A5">1). 基本导入</a></li>
<li><a href="#2-%E9%80%9A%E8%BF%87as%E5%85%B3%E9%94%AE%E5%AE%8C%E6%88%90%E6%95%B0%E6%8D%AE%E7%9A%84%E5%AF%BC%E5%85%A5">2). 通过as关键完成数据的导入</a></li>
<li><a href="#3-%E9%80%9A%E8%BF%87insert%E7%9A%84%E6%96%B9%E5%BC%8F%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE">3). 通过insert的方式导入数据</a></li>
<li><a href="#4-hdfs%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE">4). hdfs导入数据</a></li>
<li><a href="#5-%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE%E8%BF%87%E7%A8%8B%E4%B8%AD%E6%95%B0%E6%8D%AE%E7%9A%84%E8%A6%86%E7%9B%96">5). 导入数据过程中数据的覆盖</a></li>
<li><a href="#6-%E9%80%9A%E8%BF%87hdfs%E7%9A%84api%E5%AE%8C%E6%88%90%E6%96%87%E4%BB%B6%E7%9A%84%E4%B8%8A%E4%BC%A0">6). 通过HDFS的API完成文件的上传</a></li>
</ul>
</li>
<li><a href="#4-%E6%95%B0%E6%8D%AE%E7%9A%84%E5%AF%BC%E5%87%BA">4. 数据的导出</a>
<ul>
<li><a href="#1-sqoop">1). sqoop</a></li>
</ul>
</li>
<li><a href="#2-insert%E7%9A%84%E6%96%B9%E5%BC%8F">2). insert的方式</a>
<ul>
<li><a href="#3-%E9%80%9A%E8%BF%87hdfs%E7%9A%84api%E5%AE%8C%E6%88%90%E6%96%87%E4%BB%B6%E7%9A%84%E4%B8%8B%E8%BD%BD">3). 通过HDFS的API完成文件的下载</a></li>
<li><a href="#4-%E5%91%BD%E4%BB%A4%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%9A%84%E6%96%B9%E5%BC%8F">4). 命令行脚本的方式</a></li>
</ul>
</li>
<li><a href="#5-hive%E6%8F%90%E4%BE%9B%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA%E7%9A%84%E5%B7%A5%E5%85%B7">5. Hive提供导入，导出的工具</a></li>
<li><a href="#6%E4%B8%8Emr%E7%9B%B8%E5%85%B3%E7%9A%84%E9%85%8D%E7%BD%AE">6.与MR相关的配置</a></li>
</ul>
</li>
</ul>

  </div>
</div>

<script>

let lastTop = 0, lList = [], hList = [], postBody, lastIndex = -1; 
let active = 'active-show', activeClass = 'active-current';
let tocWrapper = document.querySelector('#toc_wrapper');
let tocContent = tocWrapper.children[0];

function addTocNumber(elem, deep) {
  if (!elem) {
    return;
  }
  let prop = elem.__proto__;

  if (prop === HTMLUListElement.prototype) {
    for (let i = 0; i < elem.children.length; i++) {
      addTocNumber(elem.children[i], deep + (i + 1) + '.');
    }
  } else if (prop === HTMLLIElement.prototype) {
    // 保存li元素
    lList.push(elem);
    for (let i = 0; i < elem.children.length; i++) {
      let cur = elem.children[i];
      if (cur.__proto__ === HTMLAnchorElement.prototype) {
        cur.text =  deep + ' ' + cur.text;
      } else if (cur.__proto__ === HTMLUListElement.prototype) {
        addTocNumber(cur, deep);
      }
    }
  }
}


document.addEventListener('scroll', function(e) {
  if (lList.length <= 0) {
    return;
  }
  let scrollTop = document.body.scrollTop;
  let dir;

  if (lastTop - scrollTop > 0) {
    dir = 'up';
  } else {
    dir = 'down';
  }

  lastTop = scrollTop;
  if (scrollTop <= 0) {
    if (lastIndex >= 0 && lastIndex < hList.length) {
      lList[lastIndex].classList.remove(activeClass);
    }
    return;
  }

  let current = 0, hasFind = false;
  for (let i = 0; i < hList.length; i++) {
    if (hList[i].offsetTop > scrollTop) {
      current = i;
      hasFind = true;
      break;
    }
  }
  if (!hasFind && scrollTop > lList[lList.length - 1].offsetTop) {
    current = hList.length - 1;
  } else {
    current--;
  }
  if (dir === 'down') {
    if (current > lastIndex) {
      addActiveClass(current);
      removeActiveClass(lastIndex) 
      lastIndex = current;
      removeParentActiveClass();
      lList[current] && addActiveLiElemment(lList[current].parentElement,tocContent);
    }
  } else {
    if (current < lastIndex) {
      addActiveClass(current);
      removeActiveClass(lastIndex);
      lastIndex = current;
      removeParentActiveClass();
      lList[current] && addActiveLiElemment(lList[current].parentElement,tocContent);
    }
  }
});

function removeParentActiveClass() {
  let parents = tocContent.querySelectorAll('.'+active)
  parents.forEach(function(elem) {
    elem.classList.remove(active);
  });
}

function addActiveClass(index) {
  if (index >= 0 && index < hList.length) {
    lList[index].classList.add(activeClass);
  }
}

function removeActiveClass(index) {
  if (index >= 0 && index < hList.length) {
    lList[index].classList.remove(activeClass);
  }
}

function addActiveLiElemment(elem, parent) {
  if (!elem || elem === parent) {
    return;
  } else {
    if (elem.__proto__ === HTMLLIElement.prototype) {
      elem.classList.add(active);
    }
    addActiveLiElemment(elem.parentElement, parent);
  }
}

function showToc() {
  if (tocWrapper) {
    postBody = document.querySelector('#post_body');
    for (let i = 0; i < postBody.children.length; i++) {
      if (postBody.children[i].__proto__ === HTMLHeadingElement.prototype) {
        hList.push(postBody.children[i]);
      }
    }

    if (hList.length > 10) {
      active = 'active-hidden'
      tocContent.classList.add('closed');
    } else {
      tocContent.classList.add('expanded');
    }
  }
}
addTocNumber(tocContent, '');

window.addEventListener('load', function() {
  showToc();
  document.querySelector('#sidebar').style='display: block;';
  tocWrapper.classList.add('toc-active');
  setTimeout(function() {
    if ("createEvent" in document) {
      let evt = document.createEvent("HTMLEvents");
      evt.initEvent("scroll", false, true);
      document.dispatchEvent(evt);
    }
    else {
      document.fireEvent("scroll");
    }
  }, 500)
})

</script>
          </div>
        
      </div>
    </div>
</div>
<script>
  const SIDEBAR_TITLE_ACTIVE = 'sidebar-title-active';
  const SIDEBAR_BODY_ACTIVE = 'sidebar-body-active';
  const SLIDE_UP_IN = 'slide-up-in';

  let sidebar = document.querySelector('#sidebar'),
  tocSideBar = document.querySelector('#tocSideBar'),
  metaSideBar = document.querySelector('#metaSideBar'),
  postToc = document.querySelector('#post_toc'),
  postSiteMeta = document.querySelector('#post_side_meta'),
  sidebarTitle = document.querySelector('.sidebar-title'),
  sidebarBody = document.querySelector('#sidebar_body');

  tocSideBar.addEventListener('click', (e) => {
    toggleSidebar(e);
  });

  metaSideBar.addEventListener('click', (e) => {
    toggleSidebar(e);
  });

  function toggleSidebar(e) {
    let currentTitle = document.querySelector("."+SIDEBAR_TITLE_ACTIVE);
    if (currentTitle == e.srcElement) {
      return ;
    }
    let current, showElement, hideElement;
    if (e.srcElement == metaSideBar) {
      showElement = postSiteMeta;
      hideElement = postToc;
    } else if (e.srcElement == tocSideBar){
      showElement = postToc;
      hideElement = postSiteMeta;
    }
    currentTitle.classList.remove(SIDEBAR_TITLE_ACTIVE);
    e.srcElement.classList.add(SIDEBAR_TITLE_ACTIVE);

    window.Velocity(hideElement, 'stop');
    window.Velocity(hideElement, 'transition.slideUpOut', {
      display: 'none',
      duration: 200,
      complete: function () {
        window.Velocity(showElement, 'transition.slideDownIn', {
          duration: 200
        });
      }
    })
    hideElement.classList.remove(SIDEBAR_BODY_ACTIVE);
    showElement.classList.add(SIDEBAR_BODY_ACTIVE);

  }

  postToc.addEventListener('transitionend', function() {
    this.classList.remove(SLIDE_UP_IN);
  });

  let limitTop = sidebar.offsetTop;
  let hasFix = false;
  window.addEventListener('scroll', function(e) {
    if (document.body.scrollTop >= limitTop) {
      if (!hasFix) {
        sidebar.classList.add('sidebar-fixed');
        hasFix = true;
      }
    } else {
      if (hasFix) {
        sidebar.classList.remove('sidebar-fixed');
        hasFix = false;
      }
    }
  });
</script> -->
				<!-- </div> -->
			</div>

		</div>
		<div class="footer-box">
  <footer class="footer">
    <div class="copyright">
      © 2019-2020 <i class="iconfont icon-heart"></i> Memory
    </div>
    <div class="poweredby">
      <div class="power-left">Power By<a href="https://github.com/memorypro/"> Memory</a></div>
      <div>Copy<a href="https://github.com/hsxyhao/gridea-theme-next"> Gridea NexT Theme</a></div>
      <div>Copy<a href="https://github.com/iissnan/hexo-theme-next"> Hexo Next Theme</a></div>
    </div>
  </footer>
  <div class="back-to-top" id="back_to_top">
    <i class="iconfont icon-arrow_up"></i>
    <span class="scrollpercent">
      <span id="back_to_top_text">100</span>%
    </span>
  </div>
</div>

<script>

  let body = document.body;

  let back2Top = document.querySelector('#back_to_top'),
  back2TopText = document.querySelector('#back_to_top_text');

  function scrollAnimation(currentY, targetY) {
   
    let needScrollTop = targetY - currentY
    let _currentY = currentY
    setTimeout(() => {
      const dist = Math.ceil(needScrollTop / 10)
      _currentY += dist
      window.scrollTo(_currentY, currentY)
      if (needScrollTop > 10 || needScrollTop < -10) {
        scrollAnimation(_currentY, targetY)
      } else {
        window.scrollTo(_currentY, targetY)
      }
    }, 1)
  }

  back2Top.addEventListener("click", function(e) {
    scrollAnimation(body.scrollTop, 0);
    e.stopPropagation();
    return false;
  });
  
  window.addEventListener('scroll', function(e) {
    let percent = body.scrollTop / (body.scrollHeight - body.clientHeight) * 100;
    if (percent > 1 && !back2Top.classList.contains('back-top-active')) {
      back2Top.classList.add('back-top-active');
    }
    if (percent == 0) {
      back2Top.classList.remove('back-top-active');
    }
    back2TopText.textContent = Math.floor(percent);
  });

  // 代码高亮
  hljs.initHighlightingOnLoad();
</script>

	</div>
	<!--载入js，在</body>之前插入即可-->
	<!--Leancloud 操作库:-->
	<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
	<!--Valine 的核心代码库-->
	<script src="/media/scripts/Valine.min.js"></script>

	<script>
		
		var uid = 'Xlp2Ds9RnJWmyyC4uAz8fQKM-gzGzoHsz' 
		var ukey = 'i8YPcgwSlB5my4RQsxvntlG8' 
		new Valine({
			// AV 对象来自上面引入av-min.js(老司机们不要开车➳♡゛扎心了老铁)
			av: AV,
			el: '.comment',
			lang: 'zh-cn',//设置评论语言
			emoticon_url: 'https://cloud.panjunwen.com/alu',
			emoticon_list: ["狂汗.png", "不说话.png", "汗.png", "坐等.png", "献花.png", "不高兴.png", "中刀.png", "害羞.png", "皱眉.png", "小眼睛.png", "暗地观察.png"],
			app_id:uid,
			app_key: ukey,
			placeholder: '评论留言'
		});
	</script>

</body>
<script src="/media/js/motion.js"></script>

</html>